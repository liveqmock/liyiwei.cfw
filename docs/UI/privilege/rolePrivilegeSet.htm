
<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>角色权限设置</title>
<link id="bs-css" href="../widget/charisma/css/bootstrap-spacelab.css" rel="stylesheet">
<link rel="stylesheet" href="../css/common.css"/>
<link rel="stylesheet" href="../widget/zTree/css/zTreeStyle/zTreeStyle.css" type="text/css">
<script src="../js/jquery/jquery-1.7.1.js"></script>
<script src="../js/common/jquery-common.js"></script>
<script src="../widget/zTree/js/jquery.ztree.core-3.5.js"></script>
<script src="../widget/zTree/js/jquery.ztree.excheck-3.5.js"></script>
</head>

<body>
<form name="form1" id="form1" action="rolePrivilegeSave.htm" method="post">
<input type="hidden" name="roleId" value="1"/>
<input type="hidden" id="privileges" name="privileges" value=""/>
<div class="container-fluid">
<ul class="breadcrumb"><strong><i class="icon-edit"></i> <a href="roleList.htm" class="black">角色管理</a> > 角色权限设置</strong></ul>
<table class="table table-condensed table-bordered">
  <thead>
  <tr>
    <th height="25" align="center" colspan="2"><strong>角色权限设置</strong></td>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td class="td-left"><label class="Validform_label">角色名称：&nbsp;</label></td>
    <td class="td-right">系统管理员</td>
  </tr>
  <tr>
    <td class="td-left"><label class="Validform_label">权限：&nbsp;</label></td>
    <td class="td-right"><div id="tree" class="ztree"></div></td>
  </tr>
  <tr>
    <td class="td-left">&nbsp;</td>
    <td class="td-right">
      <button type="button" id="submitBtn" class="btn btn-primary" onclick="return submitIt();"><i class="icon-ok icon-white"></i>　提　交　</button>&nbsp;
      <button type="button" class="btn" onclick="history.go(-1);"><i class="icon-share-alt"></i>　返　回　</button>
    </td>
  </tr>
  </tbody>
</table>
</div>
</form>
<script>
var setting = {
    check: {enable: true}, data: {simpleData: {enable: true}}
};
		
var zNodes =[{"id":100,"open":"true","pId":0,"name":"系统管理","isParent":"true"},{"id":101,"open":"true","pId":100,"name":"组织机构管理","isParent":"true"},{"id":102,"open":"true","pId":100,"name":"用户管理","isParent":"true"},{"id":103,"open":"true","pId":100,"name":"角色管理","isParent":"true"},{"id":104,"open":"true","pId":100,"name":"菜单管理","isParent":"true"},{"id":105,"open":"true","pId":100,"name":"数据字典管理","isParent":"true"},{"id":106,"open":"true","pId":100,"name":"系统设置","isParent":"true"},{"id":107,"open":"true","pId":100,"name":"查看操作日志","isParent":"true"},{"id":108,"open":"true","pId":100,"name":"缓存管理","isParent":"true"}];

$(document).ready(function(){
    $.fn.zTree.init($("#tree"), setting, zNodes);
});

$(document).ready(function() {
    var treeObj = $.fn.zTree.getZTreeObj("tree");
    treeObj.checkNode(treeObj.getNodeByParam("id", 100, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 101, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 102, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 103, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 104, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 105, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 106, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 107, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 108, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 200, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 201, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 202, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 203, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 204, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 205, null),true,false);
    treeObj.checkNode(treeObj.getNodeByParam("id", 206, null),true,false);
    
    $("#submitBtn").click(function() {
        var treeObj = $.fn.zTree.getZTreeObj("tree");
    	var nodes = treeObj.getCheckedNodes(true);
		v = "";
		nodes.sort(function compare(a,b){return a.id-b.id;});
		for (var i=0, l=nodes.length; i<l; i++) {
			v += nodes[i].id + ",";
		}
    	if (v.length > 0 ) v = v.substring(0, v.length-1);
    	$("#privileges").val(v);
        $("#form1").submit();
    });
});
</script>
</body>
</html>